import{u as T,j as e,f as y,i as p,L as b,y as C,K as f,z as S,t as k,J as v,w as u,x as l,v as L,b as j,N as I,O as M,n as B,d as P,P as R,e as W,q as A,m as F}from"./vendor-mui-DbcYjnqb.js";import{r as c,L as z}from"./vendor-react-Ri-ST5pw.js";import{u as N}from"./useSchoolList-CRB-QRJj.js";import"./vendor-tanstack-Cjudyj3h.js";const E=i=>{const n=T(),{count:r,page:a,rowsPerPage:d,onPageChange:o}=i,h=s=>{o(s,0)},x=s=>{o(s,a-1)},t=s=>{o(s,a+1)},g=s=>{o(s,Math.max(0,Math.ceil(r/d)-1))};return e.jsxs(y,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(p,{onClick:h,disabled:a===0,"aria-label":"first page",children:n.direction==="rtl"?e.jsx(b,{}):e.jsx(C,{})}),e.jsx(p,{onClick:x,disabled:a===0,"aria-label":"previous page",children:n.direction==="rtl"?e.jsx(f,{}):e.jsx(S,{})}),e.jsx(p,{onClick:t,disabled:a>=Math.ceil(r/d)-1,"aria-label":"next page",children:n.direction==="rtl"?e.jsx(S,{}):e.jsx(f,{})}),e.jsx(p,{onClick:g,disabled:a>=Math.ceil(r/d)-1,"aria-label":"last page",children:n.direction==="rtl"?e.jsx(C,{}):e.jsx(b,{})})]})},w={textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},K=({schools:i})=>{const[n,r]=c.useState(0),[a,d]=c.useState(12);c.useEffect(()=>r(0),[i]);const o=n>0?Math.max(0,(1+n)*a-i.length):0,h=(t,g)=>{r(g)},x=t=>{d(parseInt(t.target.value,10)),r(0)};return e.jsxs(k,{sx:{minWidth:300,p:0},"aria-label":"custom pagination table",children:[e.jsx(v,{children:e.jsxs(u,{children:[e.jsx(l,{align:"left",children:"Name"}),e.jsx(l,{align:"left",children:"City"}),e.jsx(l,{align:"right",children:"Students"}),e.jsx(l,{align:"right",children:"Website"})]})}),e.jsxs(L,{children:[(a>0?i.slice(n*a,n*a+a):i).map(t=>e.jsxs(u,{children:[e.jsx(l,{sx:{width:300},scope:"row",children:e.jsx(z,{to:"/schools/"+t.schoolId,className:"school-list-item",children:e.jsx(j,{sx:w,children:t.name})},t.schoolId)}),e.jsx(l,{sx:{width:100},scope:"row",children:e.jsx(j,{sx:w,children:t.city})}),e.jsx(l,{sx:{width:100},align:"right",children:t.total}),e.jsx(l,{sx:{width:100},align:"right",children:e.jsx(j,{sx:w,children:e.jsx("a",{href:t.url,children:t.url})})})]},t.schoolId)),o>0&&e.jsx(u,{style:{height:53*o},children:e.jsx(l,{colSpan:6})})]}),e.jsx(I,{children:e.jsx(u,{children:e.jsx(M,{rowsPerPageOptions:[12,24],colSpan:4,count:i.length,rowsPerPage:a,page:n,slotProps:{select:{inputProps:{"aria-label":"rows per page"},native:!0},actions:E},onPageChange:h,onRowsPerPageChange:x})})})]})},q=()=>{const[i,n]=c.useState(""),r=c.useDeferredValue(i),{data:a,error:d,isPending:o}=N(),h=c.useMemo(()=>a?.reduce((s,m)=>s.set(m.schoolId,m),new Map),[a]),x=c.useMemo(()=>a?.map((s,m)=>({id:s.schoolId,i:m,name:s.name.replace(/[.,/#!$%^&*;:{}=\-_'`~()]/g,"").toLowerCase()}))??[],[a]),t=c.useMemo(()=>r.replace(/[.,/#!$%^&*;:{}=\-_'`~()]/g,"").toLowerCase(),[r]),g=c.useMemo(()=>x.filter(s=>s.name.includes(t)).map(s=>h?.get(s.id)).filter(s=>s!==void 0),[x,t,h]);return e.jsxs(B,{id:"schools-list-section",component:"section",maxWidth:"xl",children:[e.jsxs(P,{direction:"row",my:3,alignItems:"center",children:[e.jsx(j,{variant:"h4",component:"h1",children:"Find a school"}),e.jsx(y,{flexGrow:1}),e.jsx(R,{value:i,onChange:s=>n(s.target.value.toLowerCase()),sx:{minWidth:300},placeholder:"Search",slotProps:{input:{startAdornment:e.jsx(W,{sx:{mr:1}})}},size:"small"})]}),d&&e.jsxs(P,{spacing:2,alignItems:"flex-start",mb:3,children:[e.jsx(j,{variant:"h6",color:"error",children:"Unable to Load Schools"}),e.jsx(j,{color:"text.secondary",children:"We're having trouble connecting to the schools database. Please check your internet connection and try again."}),e.jsx(A,{variant:"contained",onClick:()=>window.location.reload(),children:"Try Again"})]}),g.length>0&&e.jsx(K,{schools:g}),o&&e.jsx(P,{height:"50vh",direction:"column",alignItems:"center",justifyContent:"center",children:e.jsx(F,{})})]})};export{q as SchoolsListPage};
